
=== Data Shapes ===
2025-06-02 09:04:07,198 - INFO - Original: (1601409, 16)
2025-06-02 09:04:07,198 - INFO - Prepared: (1146719, 16)
2025-06-02 09:04:07,198 - INFO - Train: (573640, 3, 12), y: (573640,)
2025-06-02 09:04:07,199 - INFO - Val: (59474, 3, 12), y: (59474,)
2025-06-02 09:04:07,199 - INFO - Test: (77414, 3, 12), y: (77414,)
2025-06-02 09:04:07,199 - INFO - 
Date ranges:
2025-06-02 09:04:07,208 - INFO - Train: 3 to 26
2025-06-02 09:04:07,212 - INFO - Val: 27 to 29
2025-06-02 09:04:07,217 - INFO - Test: 30 to 33
2025-06-02 09:04:07,218 - INFO - 
Saved feature columns:
2025-06-02 09:04:07,218 - INFO - ['item_cnt_month_t0', 'item_price_t0', 'Return_t0', 'item_cnt_month_lag_1_t0', 'item_cnt_month_lag_2_t0', 'item_cnt_month_lag_3_t0', 'item_cnt_month_mean_category_t0', 'item_cnt_month_mean_shop_t0', 'item_cnt_month_mean_item_t0', 'shop_id_mean_encode_t0', 'item_id_mean_encode_t0', 'item_category_id_mean_encode_t0', 'item_cnt_month_t1', 'item_price_t1', 'Return_t1', 'item_cnt_month_lag_1_t1', 'item_cnt_month_lag_2_t1', 'item_cnt_month_lag_3_t1', 'item_cnt_month_mean_category_t1', 'item_cnt_month_mean_shop_t1', 'item_cnt_month_mean_item_t1', 'shop_id_mean_encode_t1', 'item_id_mean_encode_t1', 'item_category_id_mean_encode_t1', 'item_cnt_month_t2', 'item_price_t2', 'Return_t2', 'item_cnt_month_lag_1_t2', 'item_cnt_month_lag_2_t2', 'item_cnt_month_lag_3_t2', 'item_cnt_month_mean_category_t2', 'item_cnt_month_mean_shop_t2', 'item_cnt_month_mean_item_t2', 'shop_id_mean_encode_t2', 'item_id_mean_encode_t2', 'item_category_id_mean_encode_t2']
2025-06-02 09:04:07,219 - INFO - ✓ Verified: train_X.parquet and train_y.parquet exist
2025-06-02 09:04:07,219 - INFO - ✓ Verified: val_X.parquet and val_y.parquet exist
2025-06-02 09:04:07,219 - INFO - ✓ Verified: test_X.parquet and test_y.parquet exist
2025-06-02 09:05:24,715 - INFO - Using device: mps
2025-06-02 09:05:24,723 - INFO - Initiating program execution
2025-06-02 09:05:24,725 - INFO - Loading sample of test data for verification...
2025-06-02 09:05:24,855 - INFO - Test data sample:
shape: (5, 36)
┌───────────┬───────────┬───────────┬───────────┬───┬───────────┬───────────┬───────────┬──────────┐
│ item_cnt_ ┆ item_pric ┆ Return_t0 ┆ item_cnt_ ┆ … ┆ item_cnt_ ┆ shop_id_m ┆ item_id_m ┆ item_cat │
│ month_t0  ┆ e_t0      ┆ ---       ┆ month_lag ┆   ┆ month_mea ┆ ean_encod ┆ ean_encod ┆ egory_id │
│ ---       ┆ ---       ┆ f32       ┆ _1_t0     ┆   ┆ n_item_t2 ┆ e_t2      ┆ e_t2      ┆ _mean_en │
│ f32       ┆ f32       ┆           ┆ ---       ┆   ┆ ---       ┆ ---       ┆ ---       ┆ code_t…  │
│           ┆           ┆           ┆ f32       ┆   ┆ f32       ┆ f32       ┆ f32       ┆ ---      │
│           ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆ f32      │
╞═══════════╪═══════════╪═══════════╪═══════════╪═══╪═══════════╪═══════════╪═══════════╪══════════╡
│ -0.401862 ┆ 0.499485  ┆ 0.0       ┆ 0.804708  ┆ … ┆ -0.39393  ┆ -0.055747 ┆ 0.308244  ┆ -0.20948 │
│           ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆ 6        │
│ -0.015112 ┆ -0.611196 ┆ 0.0       ┆ 0.017729  ┆ … ┆ -0.071024 ┆ -0.055747 ┆ 0.271668  ┆ -0.08273 │
│           ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆ 4        │
│ -0.401862 ┆ -0.403677 ┆ 0.0       ┆ -0.375761 ┆ … ┆ -0.443699 ┆ -0.055747 ┆ -0.194529 ┆ -0.20948 │
│           ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆ 6        │
│ -0.401862 ┆ -0.403677 ┆ 0.0       ┆ -0.375761 ┆ … ┆ -0.417259 ┆ -0.055747 ┆ -0.194529 ┆ -0.20948 │
│           ┆           ┆           ┆           ┆   ┆           ┆           ┆           ┆ 6        │
│ -0.401862 ┆ 1.618739  ┆ 0.0       ┆ 0.017729  ┆ … ┆ 0.532169  ┆ -0.055747 ┆ 0.453643  ┆ 0.131595 │
└───────────┴───────────┴───────────┴───────────┴───┴───────────┴───────────┴───────────┴──────────┘
2025-06-02 09:05:24,895 - INFO - Test data shape: (77414, 36)
2025-06-02 09:05:24,900 - INFO - Test y shape: (77414, 1)
2025-06-02 09:05:25,020 - INFO - Columns in /Users/mohammednihal/XAI-1/training_data/train_X.parquet: ['item_cnt_month_t0', 'item_price_t0', 'Return_t0', 'item_cnt_month_lag_1_t0', 'item_cnt_month_lag_2_t0', 'item_cnt_month_lag_3_t0', 'item_cnt_month_mean_category_t0', 'item_cnt_month_mean_shop_t0', 'item_cnt_month_mean_item_t0', 'shop_id_mean_encode_t0', 'item_id_mean_encode_t0', 'item_category_id_mean_encode_t0', 'item_cnt_month_t1', 'item_price_t1', 'Return_t1', 'item_cnt_month_lag_1_t1', 'item_cnt_month_lag_2_t1', 'item_cnt_month_lag_3_t1', 'item_cnt_month_mean_category_t1', 'item_cnt_month_mean_shop_t1', 'item_cnt_month_mean_item_t1', 'shop_id_mean_encode_t1', 'item_id_mean_encode_t1', 'item_category_id_mean_encode_t1', 'item_cnt_month_t2', 'item_price_t2', 'Return_t2', 'item_cnt_month_lag_1_t2', 'item_cnt_month_lag_2_t2', 'item_cnt_month_lag_3_t2', 'item_cnt_month_mean_category_t2', 'item_cnt_month_mean_shop_t2', 'item_cnt_month_mean_item_t2', 'shop_id_mean_encode_t2', 'item_id_mean_encode_t2', 'item_category_id_mean_encode_t2']
2025-06-02 09:05:25,042 - INFO - Dataset size: 573640, X shape: (573640, 36), y shape: (573640, 1)
2025-06-02 09:05:25,514 - INFO - Columns in /Users/mohammednihal/XAI-1/training_data/val_X.parquet: ['item_cnt_month_t0', 'item_price_t0', 'Return_t0', 'item_cnt_month_lag_1_t0', 'item_cnt_month_lag_2_t0', 'item_cnt_month_lag_3_t0', 'item_cnt_month_mean_category_t0', 'item_cnt_month_mean_shop_t0', 'item_cnt_month_mean_item_t0', 'shop_id_mean_encode_t0', 'item_id_mean_encode_t0', 'item_category_id_mean_encode_t0', 'item_cnt_month_t1', 'item_price_t1', 'Return_t1', 'item_cnt_month_lag_1_t1', 'item_cnt_month_lag_2_t1', 'item_cnt_month_lag_3_t1', 'item_cnt_month_mean_category_t1', 'item_cnt_month_mean_shop_t1', 'item_cnt_month_mean_item_t1', 'shop_id_mean_encode_t1', 'item_id_mean_encode_t1', 'item_category_id_mean_encode_t1', 'item_cnt_month_t2', 'item_price_t2', 'Return_t2', 'item_cnt_month_lag_1_t2', 'item_cnt_month_lag_2_t2', 'item_cnt_month_lag_3_t2', 'item_cnt_month_mean_category_t2', 'item_cnt_month_mean_shop_t2', 'item_cnt_month_mean_item_t2', 'shop_id_mean_encode_t2', 'item_id_mean_encode_t2', 'item_category_id_mean_encode_t2']
2025-06-02 09:05:25,516 - INFO - Dataset size: 59474, X shape: (59474, 36), y shape: (59474, 1)
2025-06-02 09:05:25,598 - INFO - Columns in /Users/mohammednihal/XAI-1/training_data/test_X.parquet: ['item_cnt_month_t0', 'item_price_t0', 'Return_t0', 'item_cnt_month_lag_1_t0', 'item_cnt_month_lag_2_t0', 'item_cnt_month_lag_3_t0', 'item_cnt_month_mean_category_t0', 'item_cnt_month_mean_shop_t0', 'item_cnt_month_mean_item_t0', 'shop_id_mean_encode_t0', 'item_id_mean_encode_t0', 'item_category_id_mean_encode_t0', 'item_cnt_month_t1', 'item_price_t1', 'Return_t1', 'item_cnt_month_lag_1_t1', 'item_cnt_month_lag_2_t1', 'item_cnt_month_lag_3_t1', 'item_cnt_month_mean_category_t1', 'item_cnt_month_mean_shop_t1', 'item_cnt_month_mean_item_t1', 'shop_id_mean_encode_t1', 'item_id_mean_encode_t1', 'item_category_id_mean_encode_t1', 'item_cnt_month_t2', 'item_price_t2', 'Return_t2', 'item_cnt_month_lag_1_t2', 'item_cnt_month_lag_2_t2', 'item_cnt_month_lag_3_t2', 'item_cnt_month_mean_category_t2', 'item_cnt_month_mean_shop_t2', 'item_cnt_month_mean_item_t2', 'shop_id_mean_encode_t2', 'item_id_mean_encode_t2', 'item_category_id_mean_encode_t2']
2025-06-02 09:05:25,599 - INFO - Dataset size: 77414, X shape: (77414, 36), y shape: (77414, 1)
2025-06-02 09:06:33,531 - INFO - Epoch 1, Train MSE: 0.5871, RMSE: 0.7662, MAE: 0.4395, Val MSE: 0.2987, RMSE: 0.5465, MAE: 0.3066
2025-06-02 09:07:37,820 - INFO - Epoch 2, Train MSE: 0.4705, RMSE: 0.6860, MAE: 0.3873, Val MSE: 0.2955, RMSE: 0.5436, MAE: 0.2851
2025-06-02 09:08:41,839 - INFO - Epoch 3, Train MSE: 0.4574, RMSE: 0.6763, MAE: 0.3809, Val MSE: 0.2918, RMSE: 0.5402, MAE: 0.2944
2025-06-02 09:09:45,936 - INFO - Epoch 4, Train MSE: 0.4511, RMSE: 0.6716, MAE: 0.3777, Val MSE: 0.2912, RMSE: 0.5396, MAE: 0.2889
2025-06-02 09:10:49,806 - INFO - Epoch 5, Train MSE: 0.4443, RMSE: 0.6665, MAE: 0.3747, Val MSE: 0.2978, RMSE: 0.5457, MAE: 0.2988
2025-06-02 09:12:05,954 - INFO - Epoch 6, Train MSE: 0.4399, RMSE: 0.6632, MAE: 0.3730, Val MSE: 0.2861, RMSE: 0.5349, MAE: 0.2926
2025-06-02 09:13:10,988 - INFO - Epoch 7, Train MSE: 0.4368, RMSE: 0.6609, MAE: 0.3715, Val MSE: 0.2887, RMSE: 0.5374, MAE: 0.2920
2025-06-02 09:14:26,911 - INFO - Epoch 8, Train MSE: 0.4330, RMSE: 0.6580, MAE: 0.3703, Val MSE: 0.2905, RMSE: 0.5390, MAE: 0.2896
2025-06-02 09:15:54,345 - INFO - Epoch 9, Train MSE: 0.4316, RMSE: 0.6570, MAE: 0.3697, Val MSE: 0.2911, RMSE: 0.5395, MAE: 0.2909
2025-06-02 09:17:04,096 - INFO - Epoch 10, Train MSE: 0.4282, RMSE: 0.6543, MAE: 0.3687, Val MSE: 0.2899, RMSE: 0.5384, MAE: 0.2961
2025-06-02 09:18:18,623 - INFO - Epoch 11, Train MSE: 0.4264, RMSE: 0.6530, MAE: 0.3680, Val MSE: 0.3050, RMSE: 0.5522, MAE: 0.3179
2025-06-02 09:18:18,625 - INFO - Early stopping triggered after 11 epochs
2025-06-02 09:18:43,658 - INFO - Test MSE: 0.3310, RMSE: 0.5753, MAE: 0.3000
2025-06-02 09:18:45,128 - INFO - Program executed successfully
